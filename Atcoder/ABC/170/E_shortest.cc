#import<bits/stdc++.h>
#define I insert
#define J*--S[D].end()
#define F(V,X)D=B[C]V;T.erase(T.find(J));S[D].X(A[C]);T.I(J);
using namespace std;
int N,C,D,A[2<<17],B[2<<17];multiset<int>S[3<<17],T;main(){
    for(cin>>N>>C;D++<N;S[B[D]].I(A[D]))cin>>A[D]>>B[D];
    for(D=3e5;--D;T.I(J))S[D].I(0);
    for(;cin>>C>>N;cout<<*T.upper_bound(0)<<" "){F(,erase)F(=N,I)}}